# ğŸ§  ì–´ë¦°ì´ ê°ì²´ í–‰ë™ íŒ¨í„´ ë¶„ë¥˜ ëª¨ë¸ (MViTv2 ê¸°ë°˜)

ë³¸ í”„ë¡œì íŠ¸ëŠ” **ì–´ë¦°ì´ ë³´í˜¸êµ¬ì—­** ë“±ì—ì„œ ì–´ë¦°ì´ì˜ ë‹¤ì–‘í•œ í–‰ë™ì„ ê°ì§€í•˜ê³  ë¶„ì„í•˜ê¸° ìœ„í•´  
**MViTv2 (Multiscale Vision Transformers v2)** ëª¨ë¸ì„ í™œìš©í•˜ì—¬ ê°œë°œí•œ **ê°ì²´ í–‰ë™ íŒ¨í„´ ë¶„ë¥˜ê¸°**ì…ë‹ˆë‹¤.  
Transformer ê¸°ë°˜ì˜ ê°•ë ¥í•œ ë¶„ë¥˜ ëª¨ë¸ì„ í™œìš©í•´ ì‹¤ì œ ìŠ¤ë§ˆíŠ¸ ì‹œí‹°, êµí†µ ì•ˆì „ ì‹œìŠ¤í…œ ë“±ì— ì ìš© ê°€ëŠ¥ì„±ì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

---

## ğŸ“ í”„ë¡œì íŠ¸ ê°œìš”

- **ëª¨ë¸ ëª…ì¹­**: MViT (Multiscale Vision Transformers)
- **ëª¨ë¸ ë²„ì „**: V2â€“tiny
- **ëª¨ë¸ Task**: ì–´ë¦°ì´ ê°ì²´ì˜ í–‰ë™ íŒ¨í„´ ë¶„ë¥˜ (Classification)
- **í”„ë ˆì„ì›Œí¬**: PyTorch + MMPretrain
- **ë°ì´í„° ì¶œì²˜**: [AI Hub - ì–´ë¦°ì´ í–‰ë™ íŒ¨í„´ ì˜ìƒ ë°ì´í„°](https://www.aihub.or.kr/aihubdata/data/view.do?dataSetSn=71796)

---

## âœ… ëª¨ë¸ ì„ ì • ì´ìœ 

MViTv2ëŠ” ë‹¤ì–‘í•œ í¬ê¸°ì™€ í˜•íƒœì˜ ê°ì²´ë¥¼ ì •ë°€í•˜ê²Œ ì¸ì‹í•˜ê³  ë¶„ë¥˜í•  ìˆ˜ ìˆëŠ” ìµœì‹  Transformer ê¸°ë°˜ ëª¨ë¸ì…ë‹ˆë‹¤.  
íŠ¹íˆ ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ ë³¸ ê³¼ì œì— ì í•©í•˜ë‹¤ê³  íŒë‹¨í•˜ì˜€ìŠµë‹ˆë‹¤:

- MViTv2 ëª¨ë¸ì€ ë‹¤ì–‘í•œ í¬ê¸°ì™€ í˜•íƒœì˜ ê°ì²´ë¥¼ ì •í™•í•˜ê²Œ íƒì§€ ë° ë¶„ë¥˜í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì„ ê°–ì¶”ê³  ìˆìœ¼ë©° ì–´ë¦°ì´ ê°ì²´ í–‰ë™ íŒ¨í„´ ë¶„ë¥˜ì˜ ê²½ìš°, í¬ê¸°ì™€ í˜•íƒœê°€ ë‹¤ì–‘í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— MViTv2ì˜ ë†’ì€ ì •í™•ë„ëŠ” ì–´ë¦°ì´ ê°ì²´ì˜ í–‰ë™ íŒ¨í„´ì„ ë” ì˜ ë¶„ë¥˜í•˜ëŠ”ë° ë„ì›€ì´ ë¨. ì¶”ê°€ë¡œ í•„ìš”ì— ë”°ë¼ ëª¨ë¸ì„ ì¡°ì •í•  ìˆ˜ ìˆìœ¼ë©° ë¹ ë¥¸ ì²˜ë¦¬ì†ë„ë¡œ ì‹¤ì œ ì–´ë¦°ì´ ë³´í˜¸êµ¬ì—­ì—ì„œ ì‹ ì†í•˜ê³  ì •í™•í•œ ì–´ë¦°ì´ ê°ì²´ì˜ í–‰ë™ íŒ¨í„´ ë¶„ë¥˜ê°€ ì¤‘ìš”í•¨ìœ¼ë¡œ MVitv2 ëª¨ë¸ì„ ì„ ì •.

---

## ğŸ§  ëª¨ë¸ ê°œë°œ ê³¼ì •

### ğŸ“Œ ì‚¬ìš© ë°ì´í„°ì…‹

- **ì¶œì²˜**: [AI Hub - ì–´ë¦°ì´ í–‰ë™ íŒ¨í„´ ì˜ìƒ ë°ì´í„°ì…‹](https://www.aihub.or.kr/aihubdata/data/view.do?dataSetSn=71796)
- **êµ¬ì„±**: ë‹¤ì–‘í•œ í™˜ê²½(ì‹¤ë‚´/ì‹¤ì™¸)ì—ì„œ ì´¬ì˜ëœ ì–´ë¦°ì´ì˜ í–‰ë™ ì˜ìƒ ë° ë¼ë²¨ë§ ë°ì´í„°
- **ë¼ë²¨ ì˜ˆì‹œ**:
  - ê±·ê¸°
  - ë›°ê¸°
  - ë„ë¡œ ì§„ì…
  - ë©ˆì¶¤
  - ì£¼ì˜ ì‚°ë§Œ ë“±

### ğŸ› ï¸ ê°œë°œ ê³¼ì •

1. **ë°ì´í„° ì „ì²˜ë¦¬**  
   - í´ë˜ìŠ¤ë³„ ê· í˜• ì¡°ì •, í”„ë ˆì„ ë‹¨ìœ„ ì´ë¯¸ì§€ ë¶„ë¦¬  
   - í•™ìŠµ/ê²€ì¦/í…ŒìŠ¤íŠ¸ì…‹ìœ¼ë¡œ ë¶„í• 

2. **ëª¨ë¸ ì„¤ì • ë° í•™ìŠµ**  
   - MMPretrain í”„ë ˆì„ì›Œí¬ ê¸°ë°˜ì˜ MViTv2-tiny ì„¤ì •  
   - ImageNet ì‚¬ì „ í•™ìŠµëœ ê°€ì¤‘ì¹˜ ê¸°ë°˜ íŒŒì¸íŠœë‹ ìˆ˜í–‰

3. **ì¶”ë¡  ë° í‰ê°€**  
   - Confusion Matrix, Accuracy í‰ê°€  
   - ONNX ë³€í™˜ì„ í†µí•œ ê²½ëŸ‰í™” ë° ì‹¤ì‹œê°„ ì ìš© ê°€ëŠ¥ì„± í…ŒìŠ¤íŠ¸

---

## ğŸ’» ì‹¤í–‰ í™˜ê²½

| êµ¬ì„± í•­ëª© | í™˜ê²½ |
|-----------|------|
| OS | Ubuntu 20.04 |
| Python | 3.8+ |
| CUDA | 11.x |
| Framework | PyTorch 1.12+, MMPretrain ìµœì‹  |
| GPU | NVIDIA RTX ì‹œë¦¬ì¦ˆ ê¶Œì¥ |

---

## ğŸ“¦ ì„¤ì¹˜ ë° ì‹¤í–‰ ë°©ë²•

```bash
# 1. ê°€ìƒ í™˜ê²½ ìƒì„±
conda create -n mvitv2_env python=3.8
conda activate mvitv2_env

# 2. í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install torch torchvision
pip install openmim
mim install mmpretrain

---

## ğŸ§ª ëª¨ë¸ ì¶”ë¡  (Docker ê¸°ë°˜)

### 1. ëª¨ë¸ ì´ë¯¸ì§€ ë¡œë“œ
```bash
docker load -i nia_kids.tar
```

### 2. ì´ë¯¸ì§€ ë¡œë“œ í™•ì¸
```bash
docker images
```

> ì¶œë ¥ ì˜ˆì‹œ:
```
REPOSITORY   TAG     IMAGE ID        CREATED         SIZE
nia_kids     latest  1ff083246493    3 minutes ago   19.2GB
```

### 3. ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ë° ì¶”ë¡ 
```bash
docker run -v í…ŒìŠ¤íŠ¸ë°ì´í„°ê²½ë¡œ:/workspace/mmpretrain/kids/test_data 
-v ê²°ê³¼íŒŒì¼í™•ì¸ê²½ë¡œ:/workspace/mmpretrain/test_result -e TZ=Asia/Seoul -p 80:8080 â€“it --shm-size=8G --gpus all --name ì»¨í…Œì´ë„ˆì´ë¦„ ì´ë¯¸ì§€ì´ë¦„ 
```

### 4. ì»¨í…Œì´ë„ˆ ì ‘ì†
```bash
root@Userëª… : /mmpretrain# ---> ls
ìœ„ ë¬¸ì¥ì´ ì¶œë ¥ëœë‹¤ë©´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— ì ‘ì†ë˜ì—ˆìŠµë‹ˆë‹¤.
```

---

## âš™ï¸ ì¶”ë¡  ëª…ë ¹ì–´ ìš”ì•½

### pretrain íŒŒì¼ ì ìš©
```bash
./entrypoint.sh
overwrite!! ê°€ ëœ¨ë©´ ì™„ë£Œ
```

### ë°ì´í„° ê°€ê³µ
```bash
python kids/data_transform.py
```

### í–‰ë™ íŒ¨í„´ ì˜ˆì¸¡ ì‹¤í–‰
```bash
python tools/test.py kids/config.py kids/checkpoint.bin --work-dir tta_test --out result.pkl
```

### CSV ë³€í™˜
```bash
python result.py result.pkl
```

### ê²°ê³¼ í™•ì¸ ë° ë³µì‚¬
```bash
cp -f result.csv test_result/
```

---

## ğŸ“Š ê²°ê³¼ ì˜ˆì‹œ

| ì´ë¯¸ì§€ ê²½ë¡œ        | ì˜ˆì¸¡ ë¼ë²¨ | ì‹¤ì œ ë¼ë²¨ |
|--------------------|------------|------------|
| kids/test_c/0.png  | 1          | 1          |
| kids/test_c/1.png  | 7          | 7          |
| kids/test_c/2.png  | 7          | 7          |

---

## ğŸ”— ê´€ë ¨ ìë£Œ

- âœ… [MMPretrain MViT êµ¬í˜„ ì½”ë“œ](https://github.com/open-mmlab/mmpretrain/tree/main/configs/mvit)
- ğŸ“„ [MViT v1 ë…¼ë¬¸ (arXiv)](https://arxiv.org/abs/2104.11227)
- ğŸ“„ [MViT v2 ë…¼ë¬¸ (arXiv)](https://arxiv.org/abs/2112.01526)
- ğŸ“‚ [AI Hub ë°ì´í„°ì…‹ ìƒì„¸ ë³´ê¸°](https://www.aihub.or.kr/aihubdata/data/view.do?dataSetSn=71796)

---

## ğŸ“ˆ ê¸°ëŒ€ íš¨ê³¼ ë° í™œìš© ë°©ì•ˆ

- ì–´ë¦°ì´ ë³´í˜¸êµ¬ì—­ì—ì„œì˜ **ì‹¤ì‹œê°„ í–‰ë™ ê°ì§€ ë° ê²½ê³  ì‹œìŠ¤í…œ êµ¬ì¶•**
- ìŠ¤ë§ˆíŠ¸ CCTV ë° IoT ì—°ê³„ **ì§€ëŠ¥í˜• êµí†µ ì•ˆì „ ì‹œìŠ¤í…œ** ê°œë°œ
- ì˜ìƒ ê¸°ë°˜ í–‰ìœ„ ì¸ì‹ ì—°êµ¬ ë° ë‹¤ì–‘í•œ ë³´í–‰ì í–‰ë™ ë¶„ì„ ì‘ìš© ê°€ëŠ¥

---

## ğŸ™‹â€â™€ï¸ ê¸°ì—¬ ë° ë¬¸ì˜

í•´ë‹¹ í”„ë¡œì íŠ¸ëŠ” ëˆ„êµ¬ë‚˜ ììœ ë¡­ê²Œ í™œìš© ë° ê¸°ì—¬í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ê¶ê¸ˆí•œ ì ì´ë‚˜ ê°œì„  ì•„ì´ë””ì–´ê°€ ìˆë‹¤ë©´ ì–¸ì œë“ ì§€ ì´ìŠˆë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”!

**ë‹´ë‹¹ì**: ìµœìœ¤ì„  
ğŸ“§ nim451@naver.com

---

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ë³¸ í”„ë¡œì íŠ¸ëŠ” [MIT License](./LICENSE)ë¥¼ ë”°ë¦…ë‹ˆë‹¤.
